<!doctype html>
<html lang="en">
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>LFC Classics (Pre-1945)</title>
<meta name="description" content="Free, beginner-friendly classes that learn from public-domain masterworks before 1945.">
<style>
  body{font:16px/1.45 system-ui,Arial;margin:0;background:#f6f8fb;color:#111}
  .wrap{max-width:1100px;margin:0 auto;padding:22px 16px 64px}
  h1{margin:0 0 6px}
  .subtitle{color:#445;opacity:.8}
  .bar{display:flex;gap:8px;flex-wrap:wrap;margin:14px 0}
  input,select,label{padding:8px 10px;border:1px solid #d0d6e0;border-radius:8px;background:#fff}
  label.chk{display:flex;align-items:center;gap:6px}
  .status{margin:8px 0 0;font-size:13px}
  .status.ok{color:#0b6d45}
  .status.err{color:#a40000}
  .count{color:#445;margin:6px 0 2px}
  .grid{display:grid;gap:12px;margin-top:10px}
  @media(min-width:900px){.grid{grid-template-columns:repeat(3,1fr)}}
  .card{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:12px}
  .meta{font-size:13px;color:#556}
  .num{font-weight:700;color:#b36a00}
  .badge{display:inline-block;font-size:12px;background:#eafff1;border:1px solid #bfe8cc;color:#0c6b3a;border-radius:999px;padding:2px 8px;margin-right:6px}
  .tag{display:inline-block;font-size:12px;background:#eef2ff;border:1px solid #d7def7;color:#20346b;border-radius:999px;padding:2px 8px;margin:4px 6px 0 0}
  .links a{margin-right:8px}
  footer{margin-top:20px;color:#556;font-size:13px}
</style>
<div class="wrap">
  <h1>LFC Classics (Pre-1945)</h1>
  <div class="subtitle">Reference-first. Mini demos as bridges. Public-domain/open-access images only.</div>

  <!-- toolbar -->
  <div class="bar">
    <input id="q" placeholder="Search title / artist / tags…">
    <select id="part"><option value="">All parts</option></select>
    <select id="series"><option value="">All series</option></select>
    <select id="level"><option value="">All levels</option></select>
    <select id="section"><option value="">All sections</option></select>
    <select id="age"><option value="">All ages</option><option>6-8</option><option>9-12</option><option>13-18</option><option>all</option></select>
    <label class="chk"><input type="checkbox" id="pd"> PD/CC0 only</label>
  </div>

  <div id="status" class="status">Loading data…</div>
  <div id="count" class="count"></div>
  <div id="list" class="grid"></div>

  <footer>
    Contact: <a href="mailto:info@feiteamart.com">info@feiteamart.com</a> • Deep link: add #LFC-001 to the URL to open a class directly.
  </footer>
</div>

<script>
const DATA_SOURCES = [
  "./data/foundations.json",
  "./data/fun-sketch.json"
  // add more later: "./data/masters.json", "./data/materials.json", ...
];

let CLASSES=[];
const $=id=>document.getElementById(id);
const el={q:$('#q'),part:$('#part'),series:$('#series'),level:$('#level'),section:$('#section'),age:$('#age'),pd:$('#pd'),list:$('#list'),count:$('#count'),status:$('#status')};
const uniq=a=>[...new Set(a)].filter(Boolean).sort((x,y)=>x.localeCompare(y));
const fill=(sel,vals)=>sel.insertAdjacentHTML('beforeend',vals.map(v=>`<option>${v}</option>`).join(''));

Promise.all(DATA_SOURCES.map(u=>{
  return fetch(u).then(r=>{
    if(!r.ok) throw new Error(`Fetch failed: ${u} (${r.status})`);
    return r.json();
  }).then(j=>{
    console.log("Loaded", u, j.length, "items");
    return j;
  });
})).then(parts=>{
  CLASSES = parts.flat().sort((a,b)=>a.id.localeCompare(b.id));
  if(!CLASSES.length){ el.status.className="status err"; el.status.textContent="No classes loaded — check JSON files."; return; }
  el.status.className="status ok"; el.status.textContent="Loaded "+CLASSES.length+" classes.";
  fill(el.part,   uniq(CLASSES.map(c=>c.part)));
  fill(el.series, uniq(CLASSES.map(c=>c.series)));
  fill(el.level,  uniq(CLASSES.map(c=>c.level)));
  fill(el.section,uniq(CLASSES.map(c=>c.section)));
  [el.q,el.part,el.series,el.level,el.section,el.age,el.pd].forEach(x=>x.addEventListener('input',render));
  render();
}).catch(err=>{
  console.error("DATA LOAD ERROR:", err);
  el.status.className="status err";
  el.status.textContent = "Data load failed: " + err.message;
});

function inAge(c,band){
  if(!band||band==="all") return true;
  const [a,b]=band.split('-').map(Number);
  return c.ageMin<=b && c.ageMax>=a;
}

function render(){
  const q=(el.q.value||"").toLowerCase();
  const fp=el.part.value, fs=el.series.value, fl=el.level.value, fc=el.section.value, fa=el.age.value, fpd=el.pd.checked;
  let rows = CLASSES.filter(c=>{
    if(fp && c.part!==fp) return false;
    if(fs && c.series!==fs) return false;
    if(fl && c.level!==fl) return false;
    if(fc && c.section!==fc) return false;
    if(fa && !inAge(c,fa)) return false;
    if(fpd && !c.pd) return false;
    const hay=[c.id,c.title,c.part,c.series,c.level,c.section,c.desc,(c.tags||[]).join(' '),(c.movements||[]).join(' '),(c.artists||[]).map(a=>a.name).join(' ')].join(' ').toLowerCase();
    return hay.includes(q);
  });
  el.count.textContent = `${rows.length} shown • ${CLASSES.length} total`;
  el.list.innerHTML = rows.map(card).join('');
}

function card(c){
  const tags=(c.tags||[]).slice(0,5).map(t=>`<span class="tag">${t}</span>`).join('');
  const badge=c.pd?`<span class="badge">PD/CC0</span>`:'';
  return `
  <article class="card" id="${c.id}">
    <div class="meta"><span class="num">${c.id}</span> • ${c.part} • ${c.series} • ${c.level} • Age ${c.ageMin||'?'}–${c.ageMax||'?'} ${badge}</div>
    <h3>${c.title}</h3>
    <div class="meta">${c.desc}</div>
    <div>${tags}</div>
    <div class="links" style="margin-top:6px">
      ${c.videoUrl&&c.videoUrl!=="#" ? `<a href="${c.videoUrl}" target="_blank" rel="noopener">Video</a>`:''}
      ${c.pdfUrl&&c.pdfUrl!=="#" ? `<a href="${c.pdfUrl}" target="_blank" rel="noopener">PDF</a>`:''}
    </div>
  </article>`;
}
</script>
